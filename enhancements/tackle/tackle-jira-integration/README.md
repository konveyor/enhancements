---
title: tackle-jira-integration
authors:
  - "@rromannissen"
reviewers:
  - "@jortel"
  - "@mansam"
  - "@jwmatthews"
approvers:
  - "@jortel"
creation-date: 2022-10-28
last-updated: 2022-10-28
status: provisional
see-also:
  -  
replaces:
  -
superseded-by:
  -
---

# Tackle Hub integration with Jira


## Release Signoff Checklist

- [ ] Enhancement is `implementable`
- [ ] Design details are appropriately documented from clear requirements
- [ ] Test plan is defined
- [ ] User-facing documentation is created

## Open Questions

- There has been discussion of adding an Issue as a first class entity in the hub data model to represent issues related to modernizing an application.  For example: issues generated by analysis.  Will any of these external issues be mirrored as Tackle issues?  Or, only live in the external issue manager?
- What would be the flow for creating issues with mandatory custom fields?
- Testing strategies for the integration? Maybe building a Jira simulator that can be used as mockup for testing?
- What happens if issue creation fails? What kind of retry logic do we want to have?
- How should the repeated export be managed? For example, the applications in a Migration Wave are exported. Then, a new application that wasn't exported is added to the Migration Wave and the user clicks on Export to Issue Manager.
- Icons for each one of the statuses should be defined.


## Summary

One of the key concerns from top managers involved in modernization/migration initiatives is to know the progress of the overall project. Since most organizations have their own task management tooling, it makes sense to allow Tackle to integrate with it to leverage its capabilities. The approach would be to create tasks or issues in these task/issue managers to represent the work in a given application from the portfolio, while Tackle should be able to retrieve information about the current status of each application. This integration shouldn't be coupled with the particularities of any task/issue manager in the Tackle side, but since Jira is the most widespread tool among large organizations, it makes sense for it to be the first implementation of this integration, leaving the door open for future integrations with other task/issue managers such as GitHub issues, Remedy or Service Now.

## Motivation

This integration would provide the following advantages:

- Adoption leads are frequently not part of the organization that is executing the migration initiatives, and it is very common that these are managed by migration/adoption experts from consulting teams from GSIs and vendors. This integration would allow adoption leads to keep track of the progress of the overall initiative or at application level without having to create profiles in the corporate tooling for them, or requiring them to understand how such tooling works.
- Migrators, or the developers in charge of executing the actual changes in the applications, are often part of Third Party factories provided by partners or internal development teams belonging to the organization itself. It is fairly common for organizations to keep track of the work executed by such resources using their own task/issue trackers. This approach would avoid having to log this work twice with two different tools, and might even prevent some development teams from having to learn another additional tool.
- This integration would enable Tackle to aggregate progress and status data about the overall migration initiative, opening the door for executive dashboards that could be consumed by a potential new senior management persona.

### Goals

- Design and implement a generic integration layer with task/issue managers.
  - Provide a way to create issues/tasks on the external system.
  - Provide a way to consume information from the issues/tasks on the external system and display it in the Tackle UI.
- Implement the integration with Atlassian Jira meeting the interface requirements of the integration layer.


### Non-Goals

- Implement a [Jira App](https://marketplace.atlassian.com/addons/app/jira) of any kind.
- Design and implement the executive dashboards or tackle the senior management persona. These features will be dealt with in a potential future enhancement.

## Proposal

### Personas / Actors


#### Administrator

The administrator for the tool that has access to some application-wide configuration parameters that other users can consume but not change or browse. Example: Jira configuration, Jira Credentials.

#### Architect

A technical lead for the migration project that can create and modify applications and information related to it. The Architects don’t need to have access to sensitive information, but can consume it. Example: Create an issue from an application without knowing the credentials of a given Jira instance.



### User Stories

#### Issue Manager Configuration.

##### IMC001

*As an administrator I want to be able to configure access to multiple Jira instances*

##### IMC002

*As an administrator I want to be able to configure Jira instances of any flavor: Server, Data Center and Cloud*


##### IMC003

*As an administrator I want to be able to manage credentials to access Jira instances*


##### IMC004

*As an administrator I want to be able to configure access to Jira instances through HTTP or HTTPS, including self-signed certificates*


#### Export to issue manager

##### IME001

*As an architect I want to be able to export applications as issues in Jira*

##### IME002

*As an architect I want to be able to select the target instance to export applications to*

##### IME003

*As an architect I want to be able to select the target project to export applications to*

##### IME004

*As an architect I want to be able to select the issue type to be used when exporting the applications as issues*

#### Application migration status

##### AMS001

*As an architect I want to be able to get information about the status of the issue associated with an application*

##### AMS002

*As an architect I want to be able to get the link to the issue associated with an application*

##### AMS003

*As an architect I want to be able to derive the status of a migration wave based on the aggregation of statuses of the applications associated to that wave*

### Functional Specification

#### Issue Manager configuration in the Administrator Perspective

##### Related Use Cases

- [IMC001](#IMC001)
- [IMC002](#IMC002)
- [IMC003](#IMC003)
- [IMC004](#IMC004)


##### Involved Personas

- [Administrator](#administrator)

##### Description

###### Main view

A new entry should be added on the Control Menu on the left bar. This new option will be called Issue Management, and will have a single nested option for the moment titled Jira. Future integrations with other Issue Managers should add more nested options.

![Jira Configuration](images/admin-jira-config.png?raw=true "Jira Configuration")

Clicking in the Jira nested option will open the Jira configuration view, where the user will be able to manage Jira instances. Instances will be represented on a table, displaying the following attributes for each row:

- *Instance name*
- *URL*
- *Instance type*

###### Create instance

The administrator can create an instance by clicking the "Create instance" button. This will open a modal window with the following fields:

- *Instance name*: String
- *URL*: String
- *Instance type*: Dropdown, single selection. Values:
  - Server
  - Data Center
  - Cloud
- *Credentials*: Dropdown, single selection. Will display a list of all Jira credentials available on the system.
- *Enable insecure communication*: Toggle.


![Jira Configuration - Create Instance](images/admin-jira-config-create.png?raw=true "Jira Configuration - Create Instance")

There will be two buttons at the bottom of the modal window:
- **Save**: Validates the input and creates a new instance.
- **Cancel**: Exists the modal window. If any data has been entered, the system will ask for confirmation.


###### Edit instance

Clicking on the Edit button on the application row will open the Edit instance modal. Its contents will be the same as in the instance creation modal window, but with the contents filled with their corresponding values for the selected application.

###### Delete instance

The delete button on the application row will delete an instance after confirmation. Jira instances cannot be deleted if they host any issue associated with any application. In that case, if the user clicks on delete, the following error message will be displayed:

"**This instance contains issues associated with applications and cannot be deleted**"


#### Exporting applications as issues

##### Related Use Cases

- [IME001](#IME001)
- [IME002](#IME002)
- [IME003](#IME003)
- [IME004](#IME004)


##### Involved Personas

- [Architect](#architect)

##### Description

###### Migration Waves View

The Migration Waves view will offer a way to export all the applications associated to a wave as issues at bulk. An option for that, *Export to Issue Manager*, will be available on the kebab menu for each wave:

![Export Wave](images/waves-export-kebab-option.png?raw=true "Export wave")

Clicking on that option will open a modal window with the following fields:

- *Issue Manager*: Dropdown, single selection. The only value will be Jira for the moment, and other values will be added as more integrations are implemented.
- *Instance*: Dropdown, single selection. Will display a list of all Jira instances available on the system.
- *Project*: Dropdown, single selection. It will be populated dynamically once an instance has been selected and will contain the list of available projects in the given Jira instance the configured user has access to.
- *Issue type*: Dropdown, single selection. It will be populated dynamically once the project has been selected and will contain the list of available tasks for the given project.

![Export to Issue Manager](images/waves-export-to-issue-manager.png?raw=true "Export to Issue Manager")


There will be two buttons at the bottom of the modal window:
- **Export**: Starts the export of the list of applications associated with the Migration Wave.
- **Cancel**: Exists the modal window. If any data has been entered, the system will ask for confirmation.

#### Aggregated view of the status of a Migration Wave

##### Related Use Cases

- [AMS001](#AMS001)
- [AMS002](#AMS002)
- [AMS003](#AMS003)


##### Involved Personas

- [Architect](#architect)

##### Description

A new compound expandable section is proposed for the migration waves to reflect status data. Rows on that section will include the following fields.

- *Application Name*: Name for the given application.
- *Status*: Status of the application in the issue manager. This field should load asynchronously to reflect the latest data on the issue manager.
- *Issue*: Issue code in the issue manager with a link to the actual issue.

![Wave status](images/waves-issue-status.png?raw=true "Wave status")

At the top level of the compound expandable section, the aggregated status of the applications will be displayed in a text field with an icon. The business logic to manage both the aggregated and individual statuses is the following:

- When applications are in the process of being imported to the issue manager, the aggregated status should be *Creating Issues* and the individual application status should be *Creating Issue*.

- Once issues have been created, each issue should display their corresponding status on the issue manager. The aggregated status will display *Issues Created* if the current system date is previous to the Start Date for the wave, and *In progress* if the current system date is posterior to it.

- When all issues associated to the applications in a wave have reached the universal closed state from the issue manager, the aggregated status will display *Completed*.

- If there is any error creating an issue for an application, both its individual status and the aggregated status will display "Error".


### Implementation Details/Notes/Constraints

The Tackle-Jira integration will be implemented by a tackle2-addon component which integrates with the tackle2-hub.

This tackle2-addon-jira will be built with Java stack, following a microservice architecture with http endpoints (Spring Boot + Swagger) that the tackle2-hub uses to create Jira issues. By this way, an abstraction layer is created that can be enhanced later on to support other ticketing products through additional tackle2-addons, for instance. All communications between the tackle2-hub and this tackle2 addon for Jira, will be performed by the use of REST API Calls.

![Tackle Addon Jira Overview](images/tackle-addon-jira-overview.png?raw=true "Tackle Addon Jira Overview")

#### First iteration limitations

* This tackle addon for Jira will not mirror any data for Tackle, issues will live on Jira instance only.
* Mandatory Jira custom fields will not be supported. However, this will not a mayor issue as the creation flow will not be any different: if there is an invalid value for required fields, the API will throw an error telling field_xxxx is required together with a Bad Request HTTP error.

#### Current design limitations

* This tackle addon for Jira will act as a black box. Meaning, its clients have to decide on their error handling strategy. The data flow is "pass-through", only adapting data structures.
* In case of exporting a Migration Wave to Jira, this component will create an issue if asked to do so, but it won't track if the data sent is already present on Jira, created on a previous call.

#### Jira issue status considerations

* On Jira ecosystem, statuses do not have icons but colours.
* Statuses are grouped into Status Catogories and every category has its own colour that is not configurable.
* Right now Jira tools use the following Status Categories:
  * To-Do → Initial status with colour Blue, e.g. OPEN
  * In Progress → Intermediate status with colour Yellow, e.g. TESTING
  * Done →  Final status with colour Green, e.g. REJECTED
* Any existing status or custom ones, that are created for the use in Jira workflows, will be mapped to one of these core categories and will take on the same colour.

#### Supported Platforms

At first release, only the following products / versions are supported:

|                  | Jira Flavours                              | Product Versions |
| ---------------- | ------------------------------------------ | ---------------- |
| Jira Server      | - Jira Work Management (aka Jira Core)<br/>- Jira Software<br/>- Jira Service Management (aka Jira Service Desk)	| - Jira 7.x<br/>- Jira 8.x<br/>- Jira 9.x |
| Jira Data Center | - Jira Work Management (aka Jira Core)<br/>- Jira Software<br/>- Jira Service Management (aka Jira Service Desk) |	- Jira 7.x<br/>- Jira 8.x<br/>- Jira 9.x |
| Jira Cloud       | - Jira Work Management (aka Jira Core)<br/>- Jira Software<br/>- Jira Service Management (aka Jira Service Desk) |	- Any via API v3 |


#### Jira documentation

* [Jira Cloud REST API](https://developer.atlassian.com/cloud/jira/platform/rest/v3/intro/)
* [Jira Server / Data Center REST API](https://docs.atlassian.com/software/jira/docs/api/REST/9.3.0/)


#### Jira Communication Flow/API calls

API REST Calls from this Tackle add-on to a Jira instance will be authenticated using [Basic Authentication](https://developer.atlassian.com/cloud/jira/platform/basic-auth-for-rest-apis/) headers. Personal user accounts should not be used - only generic service accounts with a specific authentication token should be used.  It will be necessary to provide a valid username and token in order to perform any of the subsequent actions.

The user account permissions on Jira are equal for all ways of interaction. That is, if the user doesn't have permission to do an operation through Jira web interface, the user will not have permissions to do so using this add-on. Therefore, the service user account must sufficient permissions in order to execute the following actions.

This connector will act as an abstraction to Jira, handling the specifics of the different Jira implementations (Cloud, Server, Data Center).

All API endpoints follow the flow shown in the diagram below:

![Tackle Addon Jira API flow](images/tackle-addon-jira-api-flow.png?raw=true "Tackle Addon Jira API Flow")


The following endpoints will be provided by this 'tackle2-jira-connector'.



##### Jira On Premise and Jira Cloud

###### Authentication

As per design, our REST API endpoints will require Konveyor UI to provide connection data on every request as this connector has been design as stateless.
For that, we have defined three custom headers that will contain all the information required:

* `X-Atlassian-Host` — Base url of target Jira instance. I.e. https://tracker.mycompany.com/jira or https://mycompany.atlassian.net/
* `X-Atlassian-Username` — Actor used for REST API calls agains given Jira instance.
* `X-Atlassian-Password` — Related Jira password / api token for given username.

###### Test Connection

| POST /connection |
| ---------------- |
Validates the autentication data provided against a given Jira instance.
Ideally, this endpoint should only be used for [TEST CONNECTION] action in Tackle UI, when setting up a new Jira Connection.
Credential pairs need to be provided on each API call (stateless model), together with the target Jira instance.

| HEADERS |
| --------------- |
Custom headers below will be necesary for authenticatin purposes as described under 'Authentication' section above.
* X-Atlassian-Host
* X-Atlassian-Username
* X-Atlassian-Password

| QUERY PARAMETERS |
| ---------------- |
None

| BODY PARAMETERS |
| --------------- |
None

###### Listing projects

| GET /project |
| ------------ |
Returns all projects visible by the user

| HEADERS |
| --------------- |
Custom headers below will be necesary for authenticatin purposes as described under 'Authentication' section above.
* X-Atlassian-Host
* X-Atlassian-Username
* X-Atlassian-Password

| QUERY PARAMETERS |
| ---------------- |
None

| BODY PARAMETERS |
| --------------- |
None

###### Listing Issue Types

| GET /project/`{{projectId}}`/issuetype |
| ------------------------------------ |
Returns a list of all issue types in a project.

| HEADERS |
| --------------- |
Custom headers below will be necesary for authenticatin purposes as described under 'Authentication' section above.
* X-Atlassian-Host
* X-Atlassian-Username
* X-Atlassian-Password

| QUERY PARAMETERS |
| ---------------- |
`projectId` — Identifier of the Jira project you want to know their issue types.<br/>This projectId will be included as part of GET /project as response body among other meaningful data.

| BODY PARAMETERS |
| --------------- |
None


###### Creating Issues

| POST /issue |
| ----------- |
Creates an issue on Jira.
> In this first release, only Summary & Description fields will be supported (no custom fields).
> A successful request will return the new issue instance (same data as using `GET /issue/{{issueId}}`)

| HEADERS |
| --------------- |
Custom headers below will be necesary for authenticatin purposes as described under 'Authentication' section above.
* X-Atlassian-Host
* X-Atlassian-Username
* X-Atlassian-Password

| QUERY PARAMETERS |
| ---------------- |
None

| BODY PARAMETERS |
| --------------- |
`projectId` — Identifier of the Jira project you want to create this issue under.<br/>This projectId will be included as part of GET /project as response body among other meaningful data.
`issueTypeId` — Identifier of the Jira issue type (Bug, Story, Initiative,...) you want to create this issue under.<br/>This issueTypeId will be included as part of GET /project/{{projectId}}/issuetype as response body among other meaningful data. 
`fields` — An object containing one or more fields values for the creation of this issue.
`summary` — A brief summary of the issue.
`description` — A long-text description of the issue.
*An example:*
```
{
  "projectId": "10005",
  "issueTypeId": "10095", 
  "fields": {
    "summary": "Enable PayPal bridge for online payments",
    "description": "As a customer, I would like to purchase your products using my balance on paypal platform."
  }
}
```

###### Checking Issue Status

| GET /issue/`{{issueId}}` |
| ------------------------------------ |
Returns a single issue.
> In this first release, the following fields will be returned:
> * Summary
> * Description
> * Status

| HEADERS |
| --------------- |
Custom headers below will be necesary for authenticatin purposes as described under 'Authentication' section above.
* X-Atlassian-Host
* X-Atlassian-Username
* X-Atlassian-Password

| QUERY PARAMETERS |
| ---------------- |
`issueId` — Identifier of the Jira issue you want to retrieve.<br/>This issueId will be included as part of POST /issue as response body among other meaningful data.

| BODY PARAMETERS |
| --------------- |
None

### Security, Risks, and Mitigations

All communications, inbound and outbound, should be protected by TLS. The Tackle2 Jira Connector will not handle its own certificates or trust store. The default key and trust stores of the JVM apply.

It is recommended not to support self-signed certificates for TLS.

## Design Details

Every endpoint provided by this Tackle Jira Connector acts as black box. Given an input by tackle2 hub, this component handles any required logic to call Jira REST API  regardless of the destination Jira flavour (Cloud, Server, DataCenter).

### Test Plan

#### Testing Scope

The Tackle2 Jira Connector will execute unit tests on its own endpoints.

If required, Konveyor team may define integration Test Cases to ensure the whole process flow, from Konveyor UI to target Jira and back. In this case Jira target instances might be integrated using test containers.

#### Testing Type

Automated unit tests will ensure that a section of an application (each endpoint) meets its design and behaves as intended.
To isolate issues that may arise, each test case will be tested independently using method stubs, mock objects and test assertions to assist testing every endpoint in isolation. 

#### Test Cases

##### Authentication

* Call `/connection` endpoint with invalid credentials to ensure we sent back an error as response
* Call `/connection` endpoint with valid credentials to ensure we sent back an http-200 OK as response

##### Listing projects

* Call `/project` endpoint with invalid credentials to ensure that no data is leaked
* Call `/project` endpoint with valid credentials to ensure that project data is sent correctly within the response but limited to user permissions<br/>
...so if credential pair has no access to view any project, an empty list will be sent as response, otherwise the list of projects where the user has visibility will be sent as response.

##### Listing Issue Types

* Call `/project/{{projectId}}/issuetype` endpoint with invalid credentials to ensure no data is leaked
* Call `/project/{{projectId}}/issuetype` endpoint with valid credentials but invalid projectId to ensure no data is leaked
* Call `/project` endpoint with valid credentials and valid projectId to ensure data is sent correctly within the response but limited to user permissions<br>
...so if credential pair has no access to view given project, an error will be thrown, otherwise the list of issye types for selected project will be sent as response.

##### Creating Issue

* Call `/issue` endpoint with invalid credentials to ensure no data is written
* Call `/issue` endpoint with  valid credentials but invalid payload to ensure no data is written and an error is thrown instead.
* Call `/issue` endpoint with valid credentials and valid payload to ensure data is written correctly but limited to user permissions.<br/>
...so if credential pair has no access to create issues on given project, an error will be thrown, otherwise the created issue data will be sent as response.

##### Checking Issue Status

* Call `/issue/{{issueId}}` endpoint with invalid credentials to ensure no data is leaked
* Call `/issue/{{issueId}}` endpoint with  valid credentials but invalid issueId to ensure no data is leaked
* Call `/issue/{{issueId}}` endpoint with valid credentials and valid issueId to ensure data is sent correctly within the response but limited to user permissions.<br/>
...so if credential pair has no access to view given issue, an error will be thrown, otherwise the issue data will be sent as response.

### Upgrade / Downgrade Strategy

The Tackle2 Jira Connector is designed as a stateless service with a versioned API. Mayor Jira API changes will trigger a new component API version.

Automatic migration from previous to current API flows and target systems is subject to detailed study and future releases.


## Implementation History

TBD

## Drawbacks

Tackle2 is in charge of issue states, specially in case of Migration Wave issues. The Jira connector component will not save any state of whether the issue was already exported to one Jira instance or to any other ITSM instance, or not exported at all.

## Alternatives

Instead of an independent Tackle2 Addon, it would also be possibsle to integrate this Jira connector as a library into the tackle2-hub process. The pros and cons of each integration scenario should be evaluated by the Konveyor architecture team.

## Infrastructure Needed

### Runtime
The Tackle2 Jira Connector will be containerized as needed by the Konveyor Team. Kubernetes based execution is supported.

### Testing
Testing infrastructure will be required for integration tests. It should be discussed if getting infrastructure on demand is an option, or if we should consider using a simulation/mocking strategy instead.

At first version, we will only have unit testing as testing method as describe under Design Details section. However, we can further discuss how to perform integration testing to validate the whole solution from Konveyor to Jira Instance and back.

Atlassian provides trial licenses for Server and DataCenter products and free tiers for Atlassian Cloud, therefore testing environments may be set up, if needed.
